define("modules/person_bis/person-stats-bis",["jquery-full","helpers/helpers","objects/objects"],function(e,t,n){"use strict";var r={$zone:null,url:null,init:function(){this.$zone=e(".personstats_v8_5_bis");if(this.$zone.length===0)return;this.url=this.$zone.find(".tab-content").data("ajax-url");var n=t.navTabs.getElements("navtab_person-stats")[0];if(n==null)return;var r=this;n.ajax.onAfterAjaxRequest(function(){t.navTabs.reflow();var e=t.navTabs.getElements("navtab_person-stats-club")[0];e!==undefined&&e.activate(),r.initDropDowns()})},initDropDowns:function(){var e=this.$zone.find(".dropdown--national-events"),t=this.$zone.find(".dropdown--club-events"),n=this.$zone.find(".dropdown--national-seasons"),r=this.$zone.find(".dropdown--club-seasons");if(e.length&&n.length){this._onSeasonChange(n);var i=this._getActiveRecurringEvent(e);this._filterDropdownSeasonForRevId(n,i),this._changeSeasonOnRecurringEventClick(e,n)}if(t.length&&r.length){this._onSeasonChange(r);var s=this._getActiveRecurringEvent(t);this._filterDropdownSeasonForRevId(r,s),this._changeSeasonOnRecurringEventClick(t,r)}},_changeSeasonOnRecurringEventClick:function(t,n){var r=this;t.on("click",".dropdown-block-list__single-item-link",function(){var t=e(this).data("revid");r._filterDropdownSeasonForRevId(n,t)})},_onSeasonChange:function(t){var r=this,i=new n.loader;t.on("change",function(n,s){var o=s.selected.find(".dropdown-block-list__single-item-link"),u=o.data("eventid"),a=r.url+"&eventid="+u,f=e(t.data("ajax-zone-selector"));e.ajax({method:"GET",url:a,dataType:"html",beforeSend:function(){i.append(f,!0)}}).done(function(e){f.html(e)}).fail(function(e){console.log(e),i.detach(!1)}).always(function(){i.detach()})})},_getActiveRecurringEvent:function(e){return e.find(".dropdown-block-list__single-item--active .dropdown-block-list__single-item-link").data("revid")||0},_filterDropdownSeasonForRevId:function(e,n){var r,i=t.dropdowns.get(e.attr("id"));e.find(".dropdown-block-list__single-item-link").not(".dropdown-block-list__single-item-link[data-revid='"+n+"'"+"]").parent().hide(),e.find(".dropdown-block-list__single-item-link[data-revid='"+n+"'"+"]").parent().show(),r=e.find(".dropdown-block-list__single-item-link[data-revid='"+n+"'"+"]").parent().eq(0).index(),i.setCurrent(r+1)}};return{init:function(){r.init()}}}),define("modules/person_bis/person",["modules/person_bis/person-stats-bis"],function(e){e.init()}),define("person-bis",function(){});